<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>A Tour of Time Series Analysis with R</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="A Tour of Time Series Analysis with R">
  <meta name="generator" content="bookdown 0.1.16 and GitBook 2.6.7">

  <meta property="og:title" content="A Tour of Time Series Analysis with R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://tts.smac-group.com/" />
  
  
  <meta name="github-repo" content="SMAC-Group/TTS" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="A Tour of Time Series Analysis with R" />
  
  
  

<meta name="author" content="James Balamuta, StÃ©phane Guerrier, Roberto Molinari and Haotian Xu">

  
<meta name="date" content="2016-10-20">

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="joint-stationarity.html">
<link rel="next" href="autoregressive-moving-average-models.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { extensions: ["AMSmath.js"], 
         equationNumbers: { autoNumber: "AMS" },
         Macros: {
          notimplies: "\\nRightarrow",
          real: "\\mathbb{R}",
          integers: "\\mathbb{Z}",
          natural: "\\mathbb{N}",
          rational: "\\mathbb{Q}",
          irrational: "\\mathbb{P}",
          ind: "\\boldsymbol{1}",
          normal: "\\mathcal{N}",
          0: "\\boldsymbol{0}",
          e: ["\\mathbb{E} [#1]",1],
          I: "\\boldsymbol{\\mathbf{I}}",
          S: "\\boldsymbol{S}",
          y: "\\boldsymbol{y}",
          X: "\\boldsymbol{X}",
          C: "\\text{C}",
          btheta: "\\boldsymbol{\\theta}",
          epsilon: "\\varepsilon",
          bbeta: "\\boldsymbol{\\beta}", 
          bepsilon: "\\boldsymbol{\\varepsilon}", 
          norm: "\\mathcal{N}",
          KL: "\\text{KL}",
          AIC: "\\text{AIC}", 
          BIC: "\\text{BIC}", 
          mean: ["\\operatorname{mean}"],
          var: ["\\operatorname{var}"],
          tr: ["\\operatorname{tr}"],
          cov: ["\\operatorname{cov}"],
          corr: ["\\operatorname{corr}"],
          argmax: ["\\operatorname{argmax}"],
          argmin: ["\\operatorname{argmin}"],
          card: ["\\operatorname{card}"],
          diag: ["\\operatorname{diag}"],
          rank: ["\\operatorname{rank}"],
          length: ["\\operatorname{length}"]
    }
  }
});
</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="styling/style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Tour of Time Series Analysis with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="contributing.html"><a href="contributing.html"><i class="fa fa-check"></i>Contributing</a></li>
<li class="chapter" data-level="" data-path="bibliographic-note.html"><a href="bibliographic-note.html"><i class="fa fa-check"></i>Bibliographic Note</a></li>
<li class="chapter" data-level="" data-path="rendering-mathematical-formulae.html"><a href="rendering-mathematical-formulae.html"><i class="fa fa-check"></i>Rendering Mathematical Formulae</a></li>
<li class="chapter" data-level="" data-path="r-code-conventions.html"><a href="r-code-conventions.html"><i class="fa fa-check"></i>R Code Conventions</a></li>
<li class="chapter" data-level="" data-path="license.html"><a href="license.html"><i class="fa fa-check"></i>License</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="time-series.html"><a href="time-series.html"><i class="fa fa-check"></i><b>1.1</b> Time Series</a></li>
<li class="chapter" data-level="1.2" data-path="eda.html"><a href="eda.html"><i class="fa fa-check"></i><b>1.2</b> Exploratory Data Analysis for Time Series</a></li>
<li class="chapter" data-level="1.3" data-path="basicmodels.html"><a href="basicmodels.html"><i class="fa fa-check"></i><b>1.3</b> Basic Time Series Models</a><ul>
<li class="chapter" data-level="1.3.1" data-path="basicmodels.html"><a href="basicmodels.html#wn"><i class="fa fa-check"></i><b>1.3.1</b> White noise processes</a></li>
<li class="chapter" data-level="1.3.2" data-path="basicmodels.html"><a href="basicmodels.html#rw"><i class="fa fa-check"></i><b>1.3.2</b> Random Walk Processes</a></li>
<li class="chapter" data-level="1.3.3" data-path="basicmodels.html"><a href="basicmodels.html#ar1"><i class="fa fa-check"></i><b>1.3.3</b> Autoregressive Process of Order 1</a></li>
<li class="chapter" data-level="1.3.4" data-path="basicmodels.html"><a href="basicmodels.html#ma1"><i class="fa fa-check"></i><b>1.3.4</b> Moving Average Process of Order 1</a></li>
<li class="chapter" data-level="1.3.5" data-path="basicmodels.html"><a href="basicmodels.html#drift"><i class="fa fa-check"></i><b>1.3.5</b> Linear Drift</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="lts.html"><a href="lts.html"><i class="fa fa-check"></i><b>1.4</b> Composite Stochastic Processes</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="autocorrelation-and-stationarity.html"><a href="autocorrelation-and-stationarity.html"><i class="fa fa-check"></i><b>2</b> Autocorrelation and Stationarity</a><ul>
<li class="chapter" data-level="2.1" data-path="the-autocorrelation-and-autocovariance-functions.html"><a href="the-autocorrelation-and-autocovariance-functions.html"><i class="fa fa-check"></i><b>2.1</b> The Autocorrelation and Autocovariance Functions</a><ul>
<li class="chapter" data-level="2.1.1" data-path="the-autocorrelation-and-autocovariance-functions.html"><a href="the-autocorrelation-and-autocovariance-functions.html#a-fundamental-representation"><i class="fa fa-check"></i><b>2.1.1</b> A Fundamental Representation</a></li>
<li class="chapter" data-level="2.1.2" data-path="the-autocorrelation-and-autocovariance-functions.html"><a href="the-autocorrelation-and-autocovariance-functions.html#admissible-autocorrelation-functions"><i class="fa fa-check"></i><b>2.1.2</b> Admissible Autocorrelation Functions</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="stationary.html"><a href="stationary.html"><i class="fa fa-check"></i><b>2.2</b> Stationarity</a><ul>
<li class="chapter" data-level="2.2.1" data-path="stationary.html"><a href="stationary.html#assessing-weak-stationarity-of-time-series-models"><i class="fa fa-check"></i><b>2.2.1</b> Assessing Weak Stationarity of Time Series Models</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="estimation-of-moments-of-stationary-processes.html"><a href="estimation-of-moments-of-stationary-processes.html"><i class="fa fa-check"></i><b>2.3</b> Estimation of Moments of Stationary Processes</a><ul>
<li class="chapter" data-level="2.3.1" data-path="estimation-of-moments-of-stationary-processes.html"><a href="estimation-of-moments-of-stationary-processes.html#estimation-of-the-mean-function"><i class="fa fa-check"></i><b>2.3.1</b> Estimation of the Mean Function</a></li>
<li class="chapter" data-level="2.3.2" data-path="estimation-of-moments-of-stationary-processes.html"><a href="estimation-of-moments-of-stationary-processes.html#sample-autocovariance-and-autocorrelation-functions"><i class="fa fa-check"></i><b>2.3.2</b> Sample Autocovariance and Autocorrelation Functions</a></li>
<li class="chapter" data-level="2.3.3" data-path="estimation-of-moments-of-stationary-processes.html"><a href="estimation-of-moments-of-stationary-processes.html#robustness-issues"><i class="fa fa-check"></i><b>2.3.3</b> Robustness Issues</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="joint-stationarity.html"><a href="joint-stationarity.html"><i class="fa fa-check"></i><b>2.4</b> Joint Stationarity</a><ul>
<li class="chapter" data-level="2.4.1" data-path="joint-stationarity.html"><a href="joint-stationarity.html#sample-cross-covariance-and-cross-correlation-functions"><i class="fa fa-check"></i><b>2.4.1</b> Sample Cross-Covariance and Cross-Correlation Functions</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="portmanteau-test.html"><a href="portmanteau-test.html"><i class="fa fa-check"></i><b>2.5</b> Portmanteau test</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="autoregressive-moving-average-models.html"><a href="autoregressive-moving-average-models.html"><i class="fa fa-check"></i><b>3</b> Autoregressive Moving Average Models</a><ul>
<li class="chapter" data-level="3.1" data-path="linear-operators-and-processes.html"><a href="linear-operators-and-processes.html"><i class="fa fa-check"></i><b>3.1</b> Linear Operators and Processes</a><ul>
<li class="chapter" data-level="3.1.1" data-path="linear-operators-and-processes.html"><a href="linear-operators-and-processes.html#linear-operators"><i class="fa fa-check"></i><b>3.1.1</b> Linear Operators</a></li>
<li class="chapter" data-level="3.1.2" data-path="linear-operators-and-processes.html"><a href="linear-operators-and-processes.html#linear-processes"><i class="fa fa-check"></i><b>3.1.2</b> Linear Processes</a></li>
<li class="chapter" data-level="3.1.3" data-path="linear-operators-and-processes.html"><a href="linear-operators-and-processes.html#examples-of-linear-processes"><i class="fa fa-check"></i><b>3.1.3</b> Examples of Linear Processes</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="autoregressive-models.html"><a href="autoregressive-models.html"><i class="fa fa-check"></i><b>3.2</b> Autoregressive Models</a><ul>
<li class="chapter" data-level="3.2.1" data-path="autoregressive-models.html"><a href="autoregressive-models.html#properties-of-arp-models"><i class="fa fa-check"></i><b>3.2.1</b> Properties of AR(p) models</a></li>
<li class="chapter" data-level="3.2.2" data-path="autoregressive-models.html"><a href="autoregressive-models.html#estimation-of-arp-models"><i class="fa fa-check"></i><b>3.2.2</b> Estimation of AR(<span class="math inline">\(p\)</span>) models</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="appendixa.html"><a href="appendixa.html"><i class="fa fa-check"></i><b>A</b> Proofs</a><ul>
<li class="chapter" data-level="A.1" data-path="proof-of-theorem-1.html"><a href="proof-of-theorem-1.html"><i class="fa fa-check"></i><b>A.1</b> Proof of Theorem 1</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/SMAC-Group/TTS" target="blank">&copy; 2016 Balamuta, Guerrier, Molinari, Xu</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Tour of Time Series Analysis with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="portmanteau-test" class="section level2">
<h2><span class="header-section-number">2.5</span> Portmanteau test</h2>
<p>In this section we give a brief introduction to Portmanteau tests used in time series analysis. In linear regression, we always need to do diagnostic test for residuals after building our model, to check whether our assumptions are satisfied. If there is no evidence to reject any of the assumptions, we can say that the linear model we built is adequate. Otherwise, the linear models are not adequate, some modifications or transformations need to be done either for the previous model or for the data. This rule also applies to time series modeling. In time series analysis, a wide variety of Portmanteau tests can be used to check the white noise residuals assumption. We will introduce two of them as follows, which are based on the ACF of residuals, in order to illustrate some of ideas of this kind of tests.</p>
<p>Dating back to 1970, Box and Pierce proposed the well-known Box-Pierce test statistic as the following form:</p>
<p><span class="math display">\[Q_{BP} = n\sum_{h =1}^m \hat{\rho}_h^2,\]</span></p>
<p>where the empirical autocorrelation of residuals at lag <span class="math inline">\(h\)</span> is defined as <span class="math inline">\(\hat{\rho}_h = \frac{\hat{\gamma}(h)}{\hat{\gamma}(0)}\)</span>. It is obvious that under alternative hypothesis, <span class="math inline">\(\hat{\rho}_h\)</span> would be deviate from <span class="math inline">\(0\)</span>, thus a large <span class="math inline">\(Q_{BP}\)</span> gives us the evidence to reject the null. And under null hypothesis that the residuals are white noise (or equivalently the time series are adequate), it can be shown that when <span class="math inline">\(n \to \infty\)</span>, we have</p>
<p><span class="math display">\[Q_{BP} \overset{\mathcal{D}}{\to} \chi^2_{m - m^{\prime}},\]</span> where <span class="math inline">\(m^{\prime}\)</span> is the number of parameters in the time series model.</p>
<p>Then on 1978, Ljung and Box improved Box-Pierce test by standardizing each <span class="math inline">\(\hat{\rho}_h\)</span> by its asymptotic variance. The Ljung and Box test statistic is</p>
<p><span class="math display">\[Q_{LB} = n\sum_{h =1}^m \frac{n+2}{n-h}\hat{\rho}_h^2.\]</span></p>
<p>It can also be shown that <span class="math inline">\(Q_{LB} \overset{\mathcal{D}}{\to} \chi^2_{m - m^{\prime}}\)</span> under the null. However, compared to <span class="math inline">\(Q_{BP}\)</span>, the distribution of <span class="math inline">\(Q_{BP}\)</span> under the null is closer to <span class="math inline">\(\chi^2_{m - m^{\prime}}\)</span>, when <span class="math inline">\(n\)</span> is finite.</p>
<p>In the above two examples, the test statistic contains a user specified parameter <span class="math inline">\(m\)</span>. And for different <span class="math inline">\(m\)</span>, the power of the test would be different. Thus many work has been done to either select the optimal <span class="math inline">\(m\)</span>, or propose a new test statistic without user specified parameters. Moreover, testing white noise can also be done by checking PACF, or by checking the spectral density in the frequency domain. Therefore these lead to many different Portmanteau tests.</p>
<p>Take for an example the following use of a Portmanteau test to show the distribution of test statistics under the null:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(gmwm)

<span class="co"># set seed</span>
<span class="kw">set.seed</span>(<span class="dv">1345</span>)

<span class="co"># Specify models</span>
model =<span class="st"> </span><span class="kw">WN</span>(<span class="dt">sigma2 =</span> <span class="dv">1</span>) <span class="co"># WN</span>

B =<span class="st"> </span><span class="dv">1000</span> <span class="co"># number of parametric bootstrap</span>
BP.obs =<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, B)
LB.obs =<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, B)

for (j in <span class="kw">seq_len</span>(B)){
  x =<span class="st"> </span><span class="kw">gen.gts</span>(model, <span class="dt">N =</span> <span class="dv">1000</span>)
  BP.obs[j] =<span class="st"> </span><span class="kw">Box.test</span>(x, <span class="dt">lag =</span> <span class="dv">10</span>, <span class="st">&quot;Box-Pierce&quot;</span>, <span class="dt">fitdf =</span> <span class="dv">0</span>)$statistic
  LB.obs[j] =<span class="st"> </span><span class="kw">Box.test</span>(x, <span class="dt">lag =</span> <span class="dv">10</span>, <span class="st">&quot;Ljung-Box&quot;</span>, <span class="dt">fitdf =</span> <span class="dv">0</span>)$statistic
}

sim_results =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">sim =</span> <span class="kw">c</span>(BP.obs, LB.obs),
                         <span class="dt">simtype =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;Box-Pierce&quot;</span>,B), <span class="kw">rep</span>(<span class="st">&quot;Ljung-Box&quot;</span>,B)))

<span class="kw">ggplot</span>(<span class="dt">data =</span> sim_results, <span class="kw">aes</span>(<span class="dt">x =</span> sim)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">y =</span> ..density.., <span class="dt">fill =</span> simtype),
                 <span class="dt">binwidth =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) +
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dchisq, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">df =</span> <span class="dv">10</span>)) +
<span class="st">  </span><span class="kw">facet_wrap</span>( ~<span class="st"> </span>simtype) +<span class="st"> </span><span class="kw">ylim</span>(<span class="dv">0</span>, <span class="fl">0.12</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;Statistic&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Histogram of the Observed Test Statistics&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;Density&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Observed Test Statistic&quot;</span>)</code></pre></div>
<p><img src="tts_files/figure-html/dist_null_portmanteau-1.png" width="672" /></p>
<p>From the histogram, we can see that under the null the distribution of both BP and LB are close to Chi-square distribution, but LP is slightly better.</p>
<p>To show the distribution of P-values under different alternatives and show that the test depends on specified <span class="math inline">\(m\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># set seed</span>
<span class="kw">set.seed</span>(<span class="dv">1234</span>)

<span class="co"># Specify models</span>
model1 =<span class="st"> </span><span class="kw">WN</span>(<span class="dt">sigma2 =</span> <span class="dv">1</span>)                         <span class="co"># WN</span>
model2 =<span class="st"> </span><span class="kw">AR</span>(<span class="dt">phi =</span> <span class="fl">0.3</span>, <span class="dt">sigma2 =</span> <span class="dv">1</span>)              <span class="co"># AR(1)</span>
model3 =<span class="st"> </span><span class="kw">AR</span>(<span class="dt">phi =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">9</span>), <span class="fl">0.3</span>), <span class="dt">sigma2 =</span> <span class="dv">1</span>) <span class="co"># seasonal AR(10)</span>

B =<span class="st"> </span><span class="dv">1000</span> <span class="co"># number of parametric bootstrap</span>
LB.pvalue =<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="dt">nrow =</span> B, <span class="dt">ncol =</span> <span class="dv">6</span>)

for (i in <span class="dv">1</span>:<span class="dv">3</span>){
  for (j in <span class="kw">seq_len</span>(B)){
    x =<span class="st"> </span><span class="kw">gen.gts</span>(<span class="kw">get</span>(<span class="kw">paste0</span>(<span class="st">&quot;model&quot;</span>, i)), <span class="dt">N =</span> <span class="dv">1000</span>)
    LB.pvalue[j,<span class="dv">2</span>*i<span class="dv">-1</span>] =<span class="st"> </span><span class="kw">Box.test</span>(x, <span class="dt">lag =</span> <span class="dv">1</span>, <span class="st">&quot;Ljung-Box&quot;</span>, <span class="dt">fitdf =</span> <span class="dv">0</span>)$p.value
    LB.pvalue[j,<span class="dv">2</span>*i] =<span class="st"> </span><span class="kw">Box.test</span>(x, <span class="dt">lag =</span> <span class="dv">10</span>, <span class="st">&quot;Ljung-Box&quot;</span>, <span class="dt">fitdf =</span> <span class="dv">0</span>)$p.value
  }
}

para_1 =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">lag =</span> <span class="dv">1</span>, LB.pvalue[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>)])
para_2 =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">lag =</span> <span class="dv">2</span>, LB.pvalue[,<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>)])
para =<span class="st"> </span><span class="kw">rbind</span>(para_1, para_2)

<span class="kw">colnames</span>(para)[<span class="dv">2</span>:<span class="dv">4</span>] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;WN&quot;</span>, <span class="st">&quot;AR(1)&quot;</span>, <span class="st">&quot;Seasonal AR(10)&quot;</span>)

<span class="kw">library</span>(<span class="st">&quot;reshape2&quot;</span>)
para.melt =<span class="st"> </span><span class="kw">melt</span>(para, <span class="dt">id.vars =</span> <span class="st">&quot;lag&quot;</span>)

<span class="kw">ggplot</span>(<span class="dt">data =</span> para.melt, <span class="kw">aes</span>(<span class="dt">x=</span>variable, <span class="dt">y=</span>value)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">fill=</span><span class="kw">factor</span>(lag))) +<span class="st"> </span><span class="kw">facet_wrap</span>( ~<span class="st"> </span>variable, <span class="dt">scales=</span><span class="st">&quot;free&quot;</span>) +
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Simulated P-value&quot;</span>) +
<span class="st">  </span><span class="kw">scale_fill_hue</span>(<span class="dt">name=</span><span class="st">&quot;Specified m&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>) , <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;m=1&quot;</span>, <span class="st">&quot;m=10&quot;</span>))</code></pre></div>
<p><img src="tts_files/figure-html/alternatives_port-1.png" width="672" /></p>
<!--
## Exercises

1. Given three random variables $X_1$, $X_2$, and $X_3$ such that $\mathbb{\mu}  = \left[ {\begin{array}{*{20}{c}} 1 \\ 0 \\ { - 2} \end{array}} \right]$ and $\mathbb{\Sigma} = \left[ {\begin{array}{*{20}{c}} 2&0&{ - 1} \\ 0&3&{0.5} \\ { - 1}&{0.5}&1 \end{array}} \right]$ compute:
    - $\e{X_1 + X_3}$
    - $\e{3X_1 - X_2 + 4X_3}$
    - $\var(X_2 - X_3)$
    - $\var(X_2 + X_3)$
    - $\cov(4X_2 + X_1, 3X_1 - 2X_3)$
    - $\corr(X_3 + X_2, 2X_2 - 3X_1)$
1. Consider the time series of ${X_t} = {X_{t - 1}} + {W_t}$, where $W_t \sim N(0,\sigma ^2)$ and ${X_0} = 0$. Let $\bar X = \frac{1}{n}\sum\limits_{i = 1}^n {{X_i}}$. Derive the general form for $\var(\bar X)$. (Hint: $\sum\limits_{i = 1}^n {{i^2}}  = \frac{{n\left( {n + 1} \right)\left( {2n + 1} \right)}}{6}$)
1. For each of the following first construct an example and then show that it has the correct properties:
    - $(X_t)$ with constant mean but has a variance that is a function of time.
    - $(W_t)$ white noise process that is not strongly stationary.
    - $(Z_t)$ a stationary process that has an autocovariance function whose lag does not go to zero as $h > 0$.
    - $(V_t)$ that is nonstationary with an autocovariance function that depends on the lag as $h > 0$.
-->

</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="joint-stationarity.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="autoregressive-moving-average-models.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/SMAC-Group/TTS/edit/master/02-stationarity.Rmd",
"text": "Edit"
},
"download": ["tts.pdf", "tts.epub", "tts.mobi"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
