[
["index.html", "A Tour of Time Series Analysis with R Preface Contributing Bibliographic Note Rendering Mathematical Formulae R Code Conventions License", " A Tour of Time Series Analysis with R James Balamuta, Stéphane Guerrier, Roberto Molinari and Haotian Xu 2016-09-03 Preface This text is designed as an introduction to time series analysis and is used as a support document for the class STAT 429 (Time Series Analysis) given at the University of Illinois at Urbana-Champaign. It preferable to always access the text online rather than a printed to be sure you are using the latest version. The online version so affords additional features over the traditional PDF copy such as a scaling text, variety of font faces, and themed backgrounds. However, if you are in need of a local copy, a pdf version is also available. This document is under active development and as a result is likely to contains many errors. As Montesquieu puts it: “La nature semblait avoir sagement pourvu à ce que les sottises des hommes fussent passagères, et les livres les immortalisent.” Contributing If you notice any errors, we would be grateful if you would let us know. To let us know about the errors, there are two options available to you. The first and subsequently the fastest being if you are familiar with GitHub and know RMarkdown, then make a pull request and fix the issue yourself!. Note, in the online version, there is even an option to automatically start the pull request by clicking the edit button in the top-left corner of the text. The second option, that will have a slightly slower resolution time is to send an email to balamut2 AT illinois DOT edu that includes: the error and a possible revision. Please put in the subject header: [TTS]. Bibliographic Note This text is heavily inspired by the following three execellent references: “Time Series Analysis and Its Applications”, Third Edition, Robert H. Shumway &amp; David S. Stoffer. “Time Series for Macroeconomics and Finance”, John H. Cochrane. “Cours de Séries Temporelles: Théorie et Applications”, Volume 1, Arthur Charpentier. Rendering Mathematical Formulae Throughout the book, there will be mathematical symbols used to express the material. Depending on the version of the book, there are two different render engines. For the online version, the text uses MathJax to render mathematical notation for the web. In the event the formulae does not load for a specific chapter, first try to refresh the page. 9 times out of 10 the issue is related to the software library not loading quickly. For the pdf version, the text is built using the recommended AMS LaTeX symbolic packages. As a result, there should be no issue displaying equations. An example of a mathematical rendering capabilities would be given as: \\[ a^2 + b^2 = c^2 \\] R Code Conventions The code used throughout the book will predominately be R code. To obtain a copy of R, go to the Comprehensive R Archive Network (CRAN) and download the appropriate installer for your operating system. When R code is displayed it will be typeset using a monospace font with syntax highlighting enabled to ensure the differentiation of functions, variables, and so on. For example, the following adds 1 to 1 a = 1L + 1L a Each code segment may contain actual output from R. Such output will appear in grey font prefixed by ##. For example, the output of the above code segment would look like so: ## [1] 2 Alongside the PDF download of the book, you should find the R code used within each chapter. License This work is licensed under a Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License. "],
["introduction.html", "Chapter 1 Introduction 1.1 Time Series 1.2 Exploratory Data Analysis for Time Series 1.3 Basic Time Series Models 1.4 Composite Stochastic Processes", " Chapter 1 Introduction \"One damned thing after another.\" ~ R. A. Fisher > --> Prévoir consiste à projeter dans l’avenir ce qu’on a perçu dans le passé. Henri Bergson > *Hâtons-nous; le temps fuit, et nous entraîne avec soi : le moment où je parle est déjà loin de moi*. Nicolas Boileau > --> After reading this chapter you will be able to: Describe what a time series is. Perform exploratory data analysis on time series data. Evaluate different characteristics of a time series. Classify basic time series models through equations and plots. Manipulate a time series equation using backsubstitution. 1.1 Time Series Generally speaking a time series (or stochastic process) corresponds to set of “repeated” observations of the same variable such as price of a financial asset or temperature in a given location. In terms of notation a time series is often written as \\[\\left(X_1, X_2, ..., X_n \\right) \\;\\;\\; \\text{ or } \\;\\;\\; \\left(X_t\\right)_{t = 1,...,n}.\\] The time index \\(t\\) is contained within either the set of reals, \\(\\real\\), or integers, \\(\\integers\\). When \\(t \\in \\real\\), the time series becomes a continuous-time stochastic process such a Brownian motion, a model used to represent the random movement of particles within a suspended liquid or gas, or an ElectroCardioGram (ECG) signal, which corresponds to the palpitations of the heart. However, within this text, we will limit ourselves to the cases where \\(t \\in \\integers\\), better known as discrete-time processes. Discrete-time processes are where a variable is measured sequentially at fixed and equally spaced intervals in time akin to 1.1. This implies that we will have two assumptions: \\(t\\) is not random e.g. the time at which each observation is measured is known, and the time between two consecutive observations is constant. Figure 1.1: Discrete-time can be thought of as viewing a number line with equally spaced points. Moreover, the term “time series” can also represent a probability model for a set of observations. For example, one of the fundamental probability models used in time series analysis is called a white noise process and is defined as \\[W_t \\mathop \\sim \\limits^{iid} N(0, \\sigma^2).\\] This statement simply means that \\((W_t)\\) is normally distributed and independent over time. This model may appear to be dull but as we will see it is a crucial component to constructing more complex models. Unlike the white noise process, time series are typically not independent over time. Suppose that the temperature in Champaign is unusually low, then it is reasonable to assume that tomorrow’s temperature will also be low. Indeed, such behavior would suggest the existence of a dependency over time. The time series methods we will discuss in this text consists of parametric models used to characterize (or at least approximate) the joint distribution of \\((X_t)\\). Often, time series models can be decomposed into two components, the first of which is what we call a signal, say \\((Y_t)\\), and the second component is a noise, say \\((W_t)\\), leading to the model \\[X_t = Y_t + W_t.\\] Typically, we have \\(E[Y_t] \\neq 0\\) while \\(E[W_t] = 0\\) (although we may have \\(E[W_t | W_{t-1}, ..., W_1] \\neq 0\\)). Such models impose some parametric structure which represents a convenient and flexible way of studying time series as well as a means to evalute future values of the series through forecasting. As we will see, predicting future values is one of the main aspects of time series analysis. However, making predictions is often a daunting task or as famously stated by Nils Bohr: “Prediction is very difficult, especially about the future.” There are plenty of examples of predictions that turned out to be completely erroneous. For example, three days before the 1929 crash, Irving Fisher, Professor of Economics at Yale University, famously predicted: “Stock prices have reached what looks like a permanently high plateau”. Another example is given by Thomas Watson, president of IBM, who said in 1943: “I think there is a world market for maybe five computers.” 1.2 Exploratory Data Analysis for Time Series When dealing with relatively small time series (e.g. a few thousands), it is often useful to look at a graph of the original data. These graphs can be informative to “detect” some features of a time series such as trends and the presence of outliers. Indeed, a trend is typically assumed to be present in a time series when the data exhibit some form of long term increase or decrease or combination of increases or decreases. Such trends could be linear or non-linear and represent an important part of the “signal” of a model. Here are a few examples of non-linear trends: Seasonal trends (periodic): These are the cyclical patterns which repeat after a fixed/regular time period. This could be due to business cycles (e.g. bust/recession, recovery). Non-seasonal trends (periodic): These patterns cannot be associated to seasonal variation and can for example be due to an external variable such as, for example, the impact of economic indicators on stock returns. Note that such trends are often hard to detect based on a graphical analysis of the data. “Other” trends: These trends have typically no regular patterns and are over a segment of time, known as a “window”, that change the statistical properties of a time series. A common example of such trends is given by the vibrations observed before, during and after an earthquake. Example: A traditional example of a time series is the quarterly earnings of the company Johnson and Johson. In the figure below, we present these earnings between 1960 and 1980: # Load data data(jj, package = &quot;astsa&quot;) # Construct gts object jj = gts(jj, start = 1960, freq = 4, name = &#39;Johnson and Johnson Quarterly Earnings&#39;, unit = &quot;year&quot;) # Plot time series autoplot(jj) + ylab(&quot;Quarterly Earnings per Share ($)&quot;) One trait that the graph makes evident is that the data contains a non-linear increasing trend as well as a yearly seasonal component. In addition, one can note that the variability of the data seems to increase with time. Being able to make such observations provides important information to select suitable models for the data. Moreover, when observing “raw” time series data it is also interesting to evaluate if some of the following phenomena occur: Change in Mean: Does the mean of the process shift over time? Change in Variance: Does the variance of the process evolve with time? Change in State: Does the time series appear to change between “states” having distinct statistical properties? Outliers Does the time series contain some “extreme” observations? Note that this is typically difficult to assess visually. Example: In the figure below, we present an example of displacement recorded during an earthquake as well as an explosion. # Load data data(EQ5, package=&quot;astsa&quot;) data(EXP6, package=&quot;astsa&quot;) EQ5.df = fortify(EQ5) EQ5.df$type = &quot;earthquake&quot; EXP6.df = fortify(EXP6) EXP6.df$type = &quot;explosion&quot; eq.df = rbind(EQ5.df, EXP6.df) # Plot time series ggplot(data = eq.df, aes(Index, Data)) + geom_line() + facet_grid( type ~ .) + ylab(&quot;Ground Displacement (mm)&quot;) + xlab(&quot;Time (seconds)&quot;) + theme_bw() From the graph, it can be observed that the statistical properties of the time series appear to change over time. For instance, the variance of the time series shifts at around \\(t = 1150\\) for both series. The shift in variance also opens “windows” where there appear to be distinct states. In the case of the explosion data, this is particularly relevant around \\(t = 50, \\cdots, 250\\) and then again from \\(t = 1200, \\cdots, 1500\\). Even within these windows, there are “spikes” that could be considered as outliers most notably around \\(t = 1200\\) for explosion series. Extreme observations or outliers are commonly observed in real time series data, this is illustrated in the following example. Example: We consider here a data set coming from the domain of hydrology. The data concerns monthly precipitation (in mm) over a certain period of time (1907 to 1972) and is interesting for scientists in order to study water cycles. The data are presented in the graph below: # Load data hydro = read.csv(&quot;data/precipitation.csv&quot;, header=T, sep=&quot;;&quot;) # Construct gts object hydro = gts(hydro[,2], start = 1907, freq = 12, name = &#39;Precipitation Data&#39;, unit = &quot;month&quot;) # Plot data autoplot(hydro) + ylab(&quot;Mean Monthly Precipitation (mm)&quot;) Next, we consider an example coming from high-frequency finance to illustrate the limitations our current framework. Example: The figure below presents the returns or price innovations (i.e. informally speaking the changes in price from one observation to the other) for the Starbuck’s stock on July 1, 2011 for about 150 seconds (left panel) and about 400 minutes (right panel). library(timeDate) # Load &quot;high-frequency&quot; Starbucks returns for Jul 01 2011 data(sbux.xts, package = &quot;highfrequency&quot;) # Plot returns par(mfrow = c(1,2)) plot(sbux.xts[1:89], main = &quot; &quot;, ylab = &quot;Returns&quot;) plot(sbux.xts, main = &quot; &quot;, ylab = &quot;Returns&quot;) It can be observed on the left panel that observations are not equally spaced. Indeed, in high-frequency data the intervals between two points is typically not constant and, even worse, is a random variable. This implies that the time when a new observation will be available is in general unknown. On the right panel, one can observe that the variability of the data seems to change during the course of the trading day. Such a phenomenon is well known in the finance community since a lot of variation occurs at the start (and the end) of the day while the middle of the day is associated with small changes. Moreover, clear extreme observations can also be noted in this graph at around 11:00 Finally, let us consider the limitations of a direct graphical representation of a time series when the sample size is large. Indeed, due to visual limitations, a direct plotting of the data will probably result in an uninformative aggregation of points between which it is unable to distinguish anything. This is illustrated in the following example. Example: We consider here the data coming from the calibration procedure of an Inertial Measurement Unit (IMU) which, in general terms, is used to enhance navigation precision or reconstruct three dimensional movements (see e.g. link). These sensors are used in a very wide range of applications such as robotics, virtual reality, vehicle stability control, human and animal motion capture and so forth (see e.g. link). The signals coming from these instruments are measured at high frequencies over a long time and are often characterized by linear trends and numerous underlying stochastic processes. If you have never heard The code below retrieves some data from an IMU and plots it directly: # Load packages library(gmwm) library(imudata) # Load IMU data data(imu6, package = &quot;imudata&quot;) # Construct gst object Xt = gts(imu6[,1], name = &quot;Gyroscope data&quot;, unit = &quot;hour&quot;, freq = 100*60*60) # Plot time series autoplot(Xt) + ylab(expression(paste(&quot;Error &quot;, (rad/s^2)))) Although a linear trend and other processes are present in this signal (time series), it is practically impossible to understand or guess anything from the plot. 1.3 Basic Time Series Models In this section, we introduce some simple time series models. Before doing so it is useful to define \\(\\Omega_t\\) as all the information avaiable up to time \\(t-1\\), i.e. \\[\\Omega_t = \\left(X_{t-1}, X_{t-2}, ..., X_0 \\right).\\] As we will see this compact notation is quite useful. 1.3.1 White noise processes The building block for most time series models is the Gaussian white noise process, which can be defined as \\[{W_t}\\mathop \\sim \\limits^{iid} N\\left( {0,\\sigma _w^2} \\right).\\] This definition implies that: \\(E[W_t | \\Omega_t] = 0\\) for all \\(t\\), \\(\\cov\\left(W_t, W_{t-h} \\right) = \\boldsymbol{1}_{h = 0} \\; \\sigma^2\\) for all \\(t, h\\). Therefore, in this process there is an absence of temporal (or serial) dependence and is homoskedastic (i.e it has a constant variance). This definition can be generalized into two sorts of processes, the weak and strong white noise. The process \\((W_t)\\) is a weak white noise if \\(E[W_t] = 0\\) for all \\(t\\), \\(\\var\\left(W_t\\right) = \\sigma^2\\) for all \\(t\\), \\(\\cov \\left(W_t, W_{t-h}\\right) = 0\\), for all \\(t\\), and for all \\(h \\neq 0\\). Note that this definition does not imply that \\(W_t\\) and \\(W_{t-h}\\) are independent (for \\(h \\neq 0\\)) but simply uncorrelated. However, the notion of independence is used to define a strong white noise as \\(E[W_t] = 0\\) and \\(\\var(W_t) = \\sigma^2 &lt; \\infty\\), for all \\(t\\), \\(F(W_t) = F(W_{t-h})\\), for all \\(t,h\\) (where \\(F(W_t)\\) denotes the distribution of \\(W_t\\)), \\(W_t\\) and \\(W_{t-h}\\) are independent for all \\(t\\) and for all \\(h \\neq 0\\). It is clear from these definitions that if a process is a strong white noise it is also a weak white noise. However, the converse is not true as shown in the following example: Example: Let \\(Y_t \\mathop \\sim F_{t+2}\\), where \\(F_{t+2}\\) denotes a Student distribution with \\(t+2\\) degrees of freedom. Assuming the sequence \\((Y_1, \\ldots, Y_n)\\) to be independent, we let \\(X_t = \\sqrt{\\frac{t}{t+2}} Y_t\\). Then, the process \\((X_t)\\) is obviously not a strong white noise as the distribution of \\(X_t\\) changes with \\(t\\). However, this process is a weak white noise since we have: \\(E[X_t] = \\sqrt{\\frac{t}{t+2}} E[Y_t] = 0\\) for all \\(t\\). \\(\\var(X_t) = \\frac{t}{t+2} \\var(Y_t) = \\frac{t}{t+2} \\frac{t+2}{t} = 1\\) for all \\(t\\). \\(\\cov(X_t, X_{t+h}) = 0\\) (by independence), for all \\(t\\), and for all \\(h \\neq 0\\). The code below presents an example of how to simulate a Gaussian white noise process # This code simulates a gaussian white noise process n = 1000 # process length sigma2 = 1 # process variance Xt = gen.gts(WN(sigma2 = sigma2), N = n) plot(Xt) 1.3.2 Random Walk Processes The term random walk was first introduce by Karl Pearson in the early 19 hundreds. As for the white noise, there exist a large range of random walk processes. For example, one of the simplest forms of random walk can be explained as follows: suppose that you are walking on campus and your next step can either be to your left, your right, forward or backward (each with equal probability). Two realizations of such processes are represented below: library(&quot;gridExtra&quot;) # Function computes direction random walk moves RW2dimension = function(steps = 100){ # Initial matrix step_direction = matrix(0, steps+1, 2) # Start random walk for (i in seq(2, steps+1)){ # Draw a random number from U(0,1) rn = runif(1) # Go right if rn \\in [0,0.25) if (rn &lt; 0.25) {step_direction[i,1] = 1} # Go left if rn \\in [0.25,0.5) if (rn &gt;= 0.25 &amp;&amp; rn &lt; 0.5) {step_direction[i,1] = -1} # Go forward if rn \\in [0.5,0.75) if (rn &gt;= 0.5 &amp;&amp; rn &lt; 0.75) {step_direction[i,2] = 1} # Go backward if rn \\in [0.75,1] if (rn &gt;= 0.75) {step_direction[i,2] = -1} } # Cumulative steps position = data.frame(x = cumsum(step_direction[, 1]), y = cumsum(step_direction[, 2])) # Mark start and stop locations start_stop = data.frame(x = c(0, position[steps+1, 1]), y = c(0, position[steps+1, 2]), type = factor(c(&quot;Start&quot;,&quot;End&quot;), levels = c(&quot;Start&quot;,&quot;End&quot;))) # Plot results ggplot(mapping = aes(x = x, y = y)) + geom_path(data = position) + geom_point(data = start_stop, aes(color = type), size = 4) + theme_bw() + labs(x = &quot;X-position&quot;, y = &quot;Y-position&quot;, title = paste(&quot;2D random walk with&quot;, steps, &quot;steps&quot;), color = &quot;&quot;) + theme(legend.position = c(0.15, 0.84)) } # Plot 2D random walk with 10^2 and 10^5 steps set.seed(5) a = RW2dimension(steps = 10^2) b = RW2dimension(steps = 10^4) grid.arrange(a, b, nrow = 1) Such processes inspired Karl Pearson’s famous quote that “the most likely place to find a drunken walker is somewhere near his starting point.” Empirical evidence of this phenomenon is not too hard to find on a Friday night in Champaign. In this class, we only consider one very specific form of random walk, namely the Gaussian random walk which can be defined as: \\[X_t = X_{t-1} + W_t,\\] where \\(W_t\\) is a Gaussian white noise and with initial condition \\(X_0 = c\\) (typically \\(c = 0\\)). This process can be expressed differently by backsubstitution as follows: \\[\\begin{aligned} {X_t} &amp;= {X_{t - 1}} + {W_t} \\\\ &amp;= \\left( {{X_{t - 2}} + {W_{t - 1}}} \\right) + {W_t} \\\\ &amp;= \\vdots \\\\ {X_t} &amp;= \\sum\\limits_{i = 1}^t {{W_i}} + X_0 = \\sum\\limits_{i = 1}^t {{W_i}} + c \\\\ \\end{aligned} \\] The code below presents an example of how to simulate a such process # This code simulates a gaussian random walk process n = 1000 # process length gamma2 = 1 # innovation variance Xt = gen.gts(RW(gamma2 = gamma2), N = n) plot(Xt) 1.3.3 Autoregressive Process of Order 1 An autoregressive process of order 1 or AR(1) is a generalization of both the white noise and random walk processes which are both themselves special cases of an AR(1). A (Gaussian) AR(1) process can be defined as \\[{X_t} = {\\phi}{X_{t - 1}} + {W_t},\\] where \\(W_t\\) is a Gaussian white noise. Clearly, an AR(1) with \\(\\phi = 0\\) is a Gaussian white noise and when \\(\\phi = 1\\) the process becomes a random walk. Remark: We generally assume that an AR(1), as well as other time series models, have zero mean. The reason for this assumption is only to simplfy the notation but it is easy to consider an AR(1) process around an arbitrary mean \\(\\mu\\), i.e. \\[\\left(X_t - \\mu\\right) = \\phi \\left(X_{t-1} - \\mu \\right) + W_t,\\] which is of course equivalent to \\[X_t = \\left(1 - \\phi \\right) \\mu + \\phi X_{t-1} + W_t.\\] Thus, we will generally only work with zero mean processes since adding means is simple. Remark: An AR(1) is in fact a linear combination of the past realisations of the white noise \\(W_t\\). Indeed, we have \\[\\begin{aligned} {X_t} &amp;= {\\phi_t}{X_{t - 1}} + {W_t} = {\\phi}\\left( {{\\phi}{X_{t - 2}} + {W_{t - 1}}} \\right) + {W_t} \\\\ &amp;= \\phi^2{X_{t - 2}} + {\\phi}{W_{t - 1}} + {W_t} = {\\phi^t}{X_0} + \\sum\\limits_{i = 0}^{t - 1} {\\phi^i{W_{t - i}}}. \\end{aligned}\\] Under the assumption of infinite past (i.e. \\(t \\in \\mathbb{Z}\\)) and \\(|\\phi| &lt; 1\\), we obtain \\[X_t = \\sum\\limits_{i = 0}^{\\infty} {\\phi^i {W_{t - i}}},\\] since \\(\\operatorname{lim}_{i \\to \\infty} \\; {\\phi^i}{X_{t-i}} = 0\\). The code below presents an example of how an AR(1) can be simulated # This code simulate a gaussian random walk process n = 1000 # process length phi = 0.5 # phi parameter sigma2 = 1 # innovation variance Xt = gen.gts(AR1(phi = phi, sigma2 = sigma2), N = n) plot(Xt) 1.3.4 Moving Average Process of Order 1 As we have seen in the previous example, an AR(1) can be expressed as a linear combination of all past observations of \\((W_t)\\) while the next process, called a moving average process of order 1 or MA(1), is (in some sense) a “truncated” version of an AR(1). It is defined as \\begin{equation} X_t = \\theta W_{t-1} + W_t, \\label{eq:defMA1} \\end{equation} where (again) \\(W_t\\) denotes a Gaussian white noise process. An example on how to generate an MA(1) is given below: # This code simulates a gaussian white noise process n = 1000 # process length sigma2 = 1 # innovation variance theta = 0.5 # theta parameter Xt = gen.gts(MA1(theta = theta, sigma2 = sigma2), N = n) plot(Xt) 1.3.5 Linear Drift A linear drift is a very simple deterministic time series model which can be expressed as \\[X_t = X_{t-1} + \\omega, \\] where \\(\\omega\\) is a constant and with the initial condition \\(X_0 = c\\), an arbitrary constant (typically zero). This process can be expressed in a more familiar form as follows: \\[ {X_t} = {X_{t - 1}} + \\omega = \\left( {{X_{t - 2}} + \\omega} \\right) + \\omega = t{\\omega} + c \\] Therefore, a (linear) drift corresponds to a simple linear model with slope \\(\\omega\\) and intercept \\(c\\). A drift can simply be generated using the code below: # This code simulate a linear drift with 0 intercept n = 100 # process length omega = 0.5 # slope parameter Xt = gen.gts(DR(omega = omega), N = n) plot(Xt) 1.4 Composite Stochastic Processes A composite stochastic process can be defined as the sum of underlying (or latent) stochastic processes. In this text, we will use the term latent time series as a synomym for composite stochastic processes. A simple example of such a process is given by \\[\\begin{aligned} Y_t &amp;= Y_{t-1} + W_t + \\delta\\\\ X_t &amp;= Y_t + Z_t, \\end{aligned}\\] where \\(W_t\\) and \\(Z_t\\) are two independent Gaussian white noise processes. This model is often used as a first tool to approximate the number of individuals in the context ecological population dynamics. For example, suppose we want to study the population of Chamois in the Swiss Alps. Let \\(Y_t\\) denote the “true” number of individuals in this population at time \\(t\\). It is reasonable that \\(Y_t\\) is (approximately) the population at the previous time \\(t-1\\) (e.g the previous year) plus a random variation and a drift. This random variation is due to the natural randomness in ecological population dynamics and reflects the changes in the number of predators, in the aboundance of food or in the weather conditions. On the other hand, the drift is often of particular interest for ecologists as it can be used to determine the “long” term trends of the population (e.g. is the population increasing, stable or decreasing). Of course, \\(Y_t\\) (the number of individauls) is typically unknown and we observe a noisy version of it, denoted as \\(X_t\\). This process corresponds to the true population plus a measurement error since some individuals may not be observed while others may have been counted several times. Interestingly, this process can clearly be expressed as a latent time series model (or composite stochastic process) as follows: \\[\\begin{aligned} R_t &amp;= R_{t-1} + W_t \\\\ S_t &amp;= \\delta t \\\\ X_t &amp;= R_t + S_t + Z_t, \\end{aligned}\\] where \\(R_t\\), \\(S_t\\) and \\(Z_t\\) denote, respectively, a random walk, a drift and a white noise. The code below can be used to simulate such data: n = 1000 # process length delta = 0.005 # delta parameter (drift) sigma2 = 10 # variance parameter (white noise) gamma2 = 0.1 # innovation variance (random walk) model = WN(sigma2 = sigma2) + RW(gamma2 = gamma2) + DR(omega = delta) Xt = gen.lts(model, N = n) plot(Xt) In the above graph, the first three plots represent the latent (unobserved) processes (i.e. white noise, random walk and drift) and the last one represents the sum of the three (i.e. \\((X_t)\\)). Let us consider a real example where these latent processes are useful to describe (and predict) the behavior of economic variables such as Personal Saving Rates (PSR). A process that is used for these settings is the “random-walk-plus-noise” model, meaning that the data can be explained by a random walk process in addition to which we observe some other process (e.g. a white noise model, an autoregressive model such as an AR(1), etc.). The PSR taken from the Federal Reserve of St. Louis from January 1, 1959, to May 1, 2015, is presented in the following plot: # Saving Rates saving = read.csv(&quot;data/PSAVERT.csv&quot;, sep=&quot;,&quot;) # Construct gts object saving = gts(saving$VALUE, start = 1959, freq = 12, name = &#39;US Personal Saving Rates&#39;, unit = &quot;month&quot;) # Plot time series autoplot(saving) + ylab(&quot;US Personal Saving Rates (%)&quot;) It can be observed that the mean of the process seems to vary over time, suggesting that a random walk can indeed be considered as a possible model to explain this data. In addition, aside from some “spikes” and occasional sudden changes, the observations appear to gradually change from one time point to the other, suggesting that some other form of dependence between them could exist. "],
["autocorrelation-and-stationarity.html", "Chapter 2 Autocorrelation and Stationarity 2.1 The Autocorrelation and Autocovariance Functions 2.2 Stationarity", " Chapter 2 Autocorrelation and Stationarity \"I have seen the future and it is very much like the present, only longer.\" > > --- Kehlog Albran, The Profit --> “One of the first things taught in introductory statistics textbooks is that correlation is not causation. It is also one of the first things forgotten.”, Thomas Sowell In this chapter we will discuss and formalize how knowledge about \\(X_{t-1}\\) (or more generally \\(\\Omega_t\\)) can provide us with some information about the properties of \\(X_t\\). In particular, we will consider the correlation (or covariance) of \\((X_t)\\) at different times such as \\(\\corr \\left(X_t, X_{t+h}\\right)\\). This “form” of correlation (covariance) is called the autocorrelation (autocovariance) and is a very useful tool in time series analysis. However, if we do not assume that a time series is characterized by a certain form of “stability”, it would be rather difficult to estimate \\(\\corr \\left(X_t, X_{t+h}\\right)\\) as this quantity would depend on both \\(t\\) and \\(h\\) leading to more parameters to estimate than observations available. Therefore, the concept of stationarity is convenient in this context as it allows (among other things) to assume that \\[\\corr \\left(X_t, X_{t+h}\\right) = \\corr \\left(X_{t+j}, X_{t+h+j}\\right), \\;\\;\\; \\text{for all $j$},\\] implying that the autocorrelation (or autocovariance) is only a function of the lag between observations (rather than time itself). These two concepts (i.e. autocorrelation and stationarity) will be discussed in this chapter. Before moving on, it is helpful to remember that correlation (or autocorrelation) is only appropriate to measure a very specific kind of dependence, i.e. the linear dependence. There are many other forms of dependence as illustrated in the bottom panels of the graph below, which all have a (true) zero correlation: Figure 2.1: Different forms of dependence and their Pearson’s r value Several other metrics have been introduced in the literature to assess the degree of “dependence” of two random variables however this goes beyond the material discussed in this chapter. 2.1 The Autocorrelation and Autocovariance Functions 2.1.1 Definitions The autocovariance function of a series \\((X_t)\\) is defined as \\[{\\gamma_x}\\left( {t,t+h} \\right) = \\cov \\left( {{X_t},{X_{t+h}}} \\right),\\] where the definition of covariance is given by: \\[ \\cov \\left( {{X_t},{X_{t+h}}} \\right) = \\mathbb{E}\\left[ {{X_t}{X_{t+h}}} \\right] - \\mathbb{E}\\left[ {{X_t}} \\right]\\mathbb{E}\\left[ {{X_{t+h}}} \\right]. \\] Similarly, the above expectations are defined to be: \\[\\begin{aligned} \\mathbb{E}\\left[ {{X_t}} \\right] &amp;= \\int\\limits_{ - \\infty }^\\infty {x \\cdot {f_t}\\left( x \\right)dx}, \\\\ \\mathbb{E}\\left[ {{X_t}{X_{t+h}}} \\right] &amp;= \\int\\limits_{ - \\infty }^\\infty {\\int\\limits_{ - \\infty }^\\infty {{x_1}{x_2} \\cdot f_{t,t+h}\\left( {{x_1},{x_2}} \\right)d{x_1}d{x_2}} } , \\end{aligned} \\] where \\({f_t}\\left( x \\right)\\) and \\(f_{t,t+h}\\left( {{x_1},{x_2}} \\right)\\) denote, respectively, the density of \\(X_t\\) and the joint density of the pair \\((X_t, X_{t+h})\\). Since we generally consider stochastic processes with constant zero mean we often have \\[{\\gamma_x}\\left( {t,t+h} \\right) = \\mathbb{E}\\left[X_t X_{t+h} \\right]. \\] In addition, we normally drop the subscript referring to the time series (i.e. \\(x\\) in this case) if it is clear from the context which time series the autocovariance refers to. For example, we generally use \\({\\gamma}\\left( {t,t+h} \\right)\\) instead of \\({\\gamma_x}\\left( {t,t+h} \\right)\\). Moreover, the notation is even further simplified when the covariance of \\(X_t\\) and \\(X_{t+h}\\) is the same as that of \\(X_{t+j}\\) and \\(X_{t+h+j}\\) (for all \\(j\\)), i.e. the covariance depends only on the time between observations and not on the specific time \\(t\\). This is an important property called stationarity, which will be discuss in the next section. In this case, we simply use to following notation: \\[\\gamma \\left( {h} \\right) = \\cov \\left( X_t , X_{t+h} \\right). \\] This notation will generally be used throughout the text and implicitly assume certain properties (i.e. stationarity) on the process \\((X_t)\\). Several remarks can be made on the autocovariance: The autocovariance function is symmetric. That is, \\({\\gamma}\\left( {h} \\right) = {\\gamma}\\left( -h \\right)\\) since \\(\\cov \\left( {{X_t},{X_{t+h}}} \\right) = \\cov \\left( X_{t+h},X_{t} \\right)\\). The autocovariance function “contains” the variance of the process as \\(\\var \\left( X_{t} \\right) = {\\gamma}\\left( 0 \\right)\\). We have that \\(|\\gamma(h)| \\leq \\gamma(0)\\) for all \\(h\\). The proof of this inequality is direct and follows from the Cauchy-Schwarz inequality, i.e. \\[ \\begin{aligned} \\left(|\\gamma(h)| \\right)^2 &amp;= \\gamma(h)^2 = \\left(\\mathbb{E}\\left[\\left(X_t - \\mathbb{E}[X_t] \\right)\\left(X_{t+h} - \\mathbb{E}[X_{t+h}] \\right)\\right]\\right)^2\\\\ &amp;\\leq \\mathbb{E}\\left[\\left(X_t - \\mathbb{E}[X_t] \\right)^2 \\right] \\mathbb{E}\\left[\\left(X_{t+h} - \\mathbb{E}[X_{t+h}] \\right)^2 \\right] = \\gamma(0)^2. \\end{aligned} \\] Just as any covariance, \\({\\gamma}\\left( {h} \\right)\\) is “scale dependent” since \\({\\gamma}\\left( {h} \\right) \\in \\real\\), or \\(-\\infty \\le {\\gamma}\\left( {h} \\right) \\le +\\infty\\). We therefore have: if \\(\\left| {\\gamma}\\left( {h} \\right) \\right|\\) is “close” to zero, then \\(X_t\\) and \\(X_{t+h}\\) are “weakly” (linearly) dependent; if \\(\\left| {\\gamma}\\left( {h} \\right) \\right|\\) is “far” from zero, then the two random variable present a “strong” (linear) dependence. However it is generally difficult to asses what “close” and “far” from zero means in this case. \\({\\gamma}\\left( {h} \\right)=0\\) does not imply that \\(X_t\\) and \\(X_{t+h}\\) are independent but simply \\(X_t\\) and \\(X_{t+h}\\) are uncorrelated. The independence is only implied by \\({\\gamma}\\left( {h} \\right)=0\\) in the jointly Gaussian case. As hinted in the introduction, an important related statistic is the correlation of \\(X_t\\) with \\(X_{t+h}\\) or autocorrelation, which is defined as \\[\\rho \\left( h \\right) = \\corr\\left( {{X_t},{X_{t + h}}} \\right) = \\frac{{\\cov\\left( {{X_t},{X_{t + h}}} \\right)}}{{{\\sigma _{{X_t}}}{\\sigma _{{X_{t + h}}}}}} = \\frac{\\gamma(h) }{\\gamma(0)}.\\] Similarly to \\(\\gamma(h)\\), it is important to note that the above notation implies that the autocorrelation function is only a function of the lag \\(h\\) between observations. Thus, autocovariances and autocorrelations are one possible way to describe the joint distribution of a time series. Indeed, the correlation of \\(X_t\\) with \\(X_{t+1}\\) is an obvious measure of how persistent a time series is. Remember that just as with any correlation: \\(\\rho \\left( h \\right)\\) is “scale free” so it is much easier to interpret than \\(\\gamma(h)\\). \\(|\\rho \\left( h \\right)| \\leq 1\\) since \\(|\\gamma(h)| \\leq \\gamma(0)\\). Causation and correlation are two very different things! 2.1.2 A Fundamental Representation Autocovariances and autocorrelations also turn out to be a very useful tool because they are one of the fundamental representations of time series. Indeed, if we consider a zero mean normally distributed process, it is clear that its joint distribution is fully characterized by the autocariances \\(\\mathbb{E}[X_t X_{t+h}]\\) (since the joint probability density only depends of these covariances). Once we know the autocovariances we know everything there is to know about the process and therefore: if two processes have the same autocovariance function, then they are the same process. 2.1.3 Admissible Autocorrelation Functions Since the autocorrelation is related to a fundamental representation of time series, it implies that one might be able to define a stochastic process by picking a set of autocorrelation values (assuming for example that \\(\\var(X_t) = 1\\)). However, it turns out that not every collection of numbers, say \\(\\{\\rho_1, \\rho_2, ...\\}\\), can represent the autocorrelation of a process. Indeed, two conditions are required to ensure the validity of an autocorrelation sequence: \\(\\operatorname{max}_j \\; | \\rho_j| \\leq 1\\). \\(\\var \\left[\\sum_{j = 0}^\\infty \\alpha_j X_{t-j} \\right] \\geq 0 \\;\\) for all \\(\\{\\alpha_0, \\alpha_1, ...\\}\\). The first condition is obvious and simply reflects the fact that \\(|\\rho \\left( h \\right)| \\leq 1\\) but the second is far more difficult to verify. To further our understanding of the latter we let \\(\\alpha_j = 0\\) for \\(j &gt; 1\\), then condition 2 implies that \\[\\var \\left[ \\alpha_0 X_{t} + \\alpha_1 X_{t-1} \\right] = \\gamma_0 \\begin{bmatrix} \\alpha_0 &amp; \\alpha_1 \\end{bmatrix} \\begin{bmatrix} 1 &amp; \\rho_1\\\\ \\rho_1 &amp; 1 \\end{bmatrix} \\begin{bmatrix} \\alpha_0 \\\\ \\alpha_1 \\end{bmatrix} \\geq 0. \\] Thus, the matrix \\[ \\boldsymbol{A}_1 = \\begin{bmatrix} 1 &amp; \\rho_1\\\\ \\rho_1 &amp; 1 \\end{bmatrix} \\] must be positive semi-definite. Taking the determinant we have \\[\\operatorname{det} \\left(\\boldsymbol{A}_1\\right) = 1 - \\rho_1^2 \\] implying that the condition \\(|\\rho_1| &lt; 1\\) must be respected. Now, let \\(\\alpha_j = 0\\) for \\(j &gt; 2\\), then we must verify that: \\[\\var \\left[ \\alpha_0 X_{t} + \\alpha_1 X_{t-1} + \\alpha_2 X_{t-2} \\right] = \\gamma_0 \\begin{bmatrix} \\alpha_0 &amp; \\alpha_1 &amp;\\alpha_2 \\end{bmatrix} \\begin{bmatrix} 1 &amp; \\rho_1 &amp; \\rho_2\\\\ \\rho_1 &amp; 1 &amp; \\rho_1 \\\\ \\rho_2 &amp; \\rho_1 &amp; 1 \\end{bmatrix} \\begin{bmatrix} \\alpha_0 \\\\ \\alpha_1 \\\\ \\alpha_2 \\end{bmatrix} \\geq 0. \\] Again, this implies that the matrix \\[ \\boldsymbol{A}_2 = \\begin{bmatrix} 1 &amp; \\rho_1 &amp; \\rho_2\\\\ \\rho_1 &amp; 1 &amp; \\rho_1 \\\\ \\rho_2 &amp; \\rho_1 &amp; 1 \\end{bmatrix} \\] must be positive semi-definite and it is easy to verify that \\[\\operatorname{det} \\left(\\boldsymbol{A}_2\\right) = \\left(1 - \\rho_2 \\right)\\left(- 2 \\rho_1^2 + \\rho_2 + 1\\right). \\] Thus, this implies that \\(|\\rho_2| &lt; 1\\) as well as \\[\\begin{aligned} &amp;- 2 \\rho_1^2 + \\rho_2 + 1 \\geq 0 \\Rightarrow 1 &gt; \\rho_2 \\geq 2 \\rho_1^2 - 1 \\\\ &amp;\\Rightarrow 1 - \\rho_1^2 &gt; \\rho_2 - \\rho_1^2 \\geq -(1 - \\rho_1^2)\\\\ &amp;\\Rightarrow 1 &gt; \\frac{\\rho_2 - \\rho_1^2 }{1 - \\rho_1^2} \\geq -1. \\end{aligned}\\] Therefore, \\(\\rho_1\\) and \\(\\rho_2\\) must lie in a parabolic shaped region defined by the above inequalities as illustrated in Figure 2.2. Figure 2.2: Admissible autocorrelation functions From our derivation it is clear that the restrictions on the autocorrelation are very complicated thereby justifying the need for other forms of fundamental representation which we will explore later in this text. Before moving on to the estimation of the autocorrelation and autocovariance functions, we must first discuss the stationarity of \\((X_t)\\), which will provide a convenient framework in which \\(\\gamma(h)\\) and \\(\\rho(h)\\) can be used (rather that \\(\\gamma(t,t+h)\\) for example) and (easily) estimated. 2.2 Stationarity 2.2.1 Definitions There are two kinds of stationarity that are commonly used. They are defined below: A process \\((X_t)\\) is strongly stationary or strictly stationary if the joint probability distribution of \\((X_{t-h}, ..., X_t, ..., X_{t+h})\\) is independent of \\(t\\) for all \\(h\\). A process \\((X_t)\\) is weakly stationary, covariance stationary or second order stationary if \\(\\mathbb{E}[X_t]\\), \\(\\mathbb{E}[X_t^2]\\) are finite and \\(\\mathbb{E}[X_t X_{t-h}]\\) depends only on \\(h\\) and not on \\(t\\). These types of stationarity are not equivalent and the presence of one kind of stationarity does not imply the other. That is, a time series can be strongly stationary but not weakly stationary and vice versa. In some cases, a time series can be both strongly and weakly stationary and this is occurs, for example, in the (jointly) Gaussian case. Stationarity of \\((X_t)\\) matters because it provides the framework in which averaging dependent data makes sense thereby allowing to easily estimate quantities such as the autocorrelation function. Several remarks and comments can be made on these definitions: As mentioned earlier, strong stationarity does not imply weak stationarity. Example: an iid Cauchy process is strongly but not weakly stationary. Weak stationarity does not imply strong stationarity. Example: Consider the following weak white noise process: \\begin{equation*} X_t = \\begin{cases} U_{t} &amp; \\quad \\text{if } t \\in \\{2k:\\, k\\in \\mathbb{Z} \\}, \\\\ V_{t} &amp; \\quad \\text{if } t \\in \\{2k+1:\\, k\\in \\mathbb{Z} \\},\\\\ \\end{cases} \\end{equation*} where \\({U_t} \\mathop \\sim \\limits^{iid} N\\left( {1,1} \\right)\\) and \\({V_t}\\mathop \\sim \\limits^{iid} \\mathcal{E}\\left( 1 \\right)\\) is a weakly stationary process that is not strongly stationary. Strong stationarity combined with bounded values of \\(\\mathbb{E}[X_t]\\) and \\(\\mathbb{E}[X_t^2]\\) implies weak stationarity Weak stationarity combined with normality distributed processes implies strong stationarity. 2.2.2 Assessing Weak Stationarity of Time Series Models It is important to understand how to verify if a postulated model is (weakly) stationary. In order to do so, we must ensure that our model satisfies the following three properties: \\(\\mathbb{E}\\left[X_t \\right] = \\mu_t = \\mu &lt; \\infty\\), \\(\\var\\left[X_t \\right] = \\sigma^2_t = \\sigma^2 &lt; \\infty\\), \\(\\cov\\left(X_t, X_{t+h} \\right) = \\gamma \\left(h\\right)\\). In the following examples we evaluate the stationarity of the processes introduced in Section 1.3. Example: Gaussian White Noise It is easy to verify that this process is stationary. Indeed, we have: \\(\\mathbb{E}\\left[ {{X_t}} \\right] = 0\\), \\(\\gamma(0) = \\sigma^2 &lt; \\infty\\), \\(\\gamma(h) = 0\\) for \\(|h| &gt; 0\\). Example: Random Walk To evaluate the stationarity of this process we first derive its properties: We begin by calculating the expectation of the process \\[ \\mathbb{E}\\left[ {{X_t}} \\right] = \\mathbb{E}\\left[ {{X_{t - 1}} + {W_t}} \\right] = \\mathbb{E}\\left[ {\\sum\\limits_{i = 1}^t {{W_i}} + {X_0}} \\right] = \\mathbb{E}\\left[ {\\sum\\limits_{i = 1}^t {{W_i}} } \\right] + {c} = c. \\] Observe that the mean obtained is constant since it depends only on the value of the first term in the sequence. Next, after finding the mean to be constant, we calculate the variance to check stationarity: \\[\\begin{aligned} \\var\\left( {{X_t}} \\right) &amp;= \\var\\left( {\\sum\\limits_{i = 1}^t {{W_t}} + {X_0}} \\right) = \\var\\left( {\\sum\\limits_{i = 1}^t {{W_i}} } \\right) + \\underbrace {\\var\\left( {{X_0}} \\right)}_{= 0} \\\\ &amp;= \\sum\\limits_{i = 1}^t {\\var\\left( {{W_i}} \\right)} = t \\sigma_w^2, \\end{aligned}\\] where \\(\\sigma_w^2 = \\var(W_t)\\). Therefore, the variance depends on time \\(t\\) contradicting our second property. Moreover, we have: \\[\\mathop {\\lim }\\limits_{t \\to \\infty } \\; \\var\\left(X_t\\right) = \\infty.\\] This process is therefore not weakly stationary. Regarding the autocovariance of a random walk we have: \\[\\begin{aligned} \\gamma \\left( h \\right) &amp;= \\cov\\left( {{X_t},{X_{t + h}}} \\right) = \\cov\\left( {\\sum\\limits_{i = 1}^t {{W_i}} ,\\sum\\limits_{j = 1}^{t + h} {{W_j}} } \\right) = \\cov\\left( {\\sum\\limits_{i = 1}^t {{W_i}} ,\\sum\\limits_{j = 1}^t {{W_j}} } \\right)\\\\ &amp;= \\min \\left( {t,t + h} \\right)\\sigma _w^2 = \\left( {t + \\min \\left( {0,h} \\right)} \\right)\\sigma _w^2, \\end{aligned} \\] which further illustrates the non-stationarity of this process. Moreover, the autocorrelation of this process is given by \\[\\rho (h) = \\frac{t + \\min \\left( {0,h} \\right)}{\\sqrt{t}\\sqrt{t+h}},\\] implying (for a fixed \\(h\\)) that \\[\\mathop {\\lim }\\limits_{t \\to \\infty } \\; \\rho(h) = 1.\\] In the following simulated example, we illustrate the non-stationary feature of such a process: # In this example, we simulate a large number of random walks # Number of simulated processes B = 200 # Length of random walks n = 1000 # Output matrix out = matrix(NA,B,n) # Set seed for reproducibility set.seed(6182) # Simulate Data for (i in seq_len(B)){ # Simulate random walk Xt = gen.gts(RW(gamma=1), N = n) # Store process out[i,] = Xt } # Plot random walks plot(NA, xlim = c(1,n), ylim = range(out), xlab = &quot;Time&quot;, ylab = &quot; &quot;) color = sample(topo.colors(B, alpha = 0.5)) for (i in seq_len(B)){ lines(out[i,], col = color[i]) } # Add 95% confidence region lines(1:n, 1.96*sqrt(1:n), col = 2, lwd = 2, lty = 2) lines(1:n, -1.96*sqrt(1:n), col = 2, lwd = 2, lty = 2) Figure 2.3: Two hundred simulated random walks. In the plot, two hundred simulated random walks are plotted along with the theoretical 95% confidence intervals (red-dashed lines). The relationship between time and variance can clearly be observed (i.e. the variance of the process increases with the time). Example: MA(1) Similarly to our previous examples, we attempt to verify the stationary properties for the MA(1) model defined in Section 1.3.4: \\[ \\mathbb{E}\\left[ {{X_t}} \\right] = \\mathbb{E}\\left[ {{\\theta_1}{W_{t - 1}} + {W_t}} \\right] = {\\theta_1} \\mathbb{E} \\left[ {{W_{t - 1}}} \\right] + \\mathbb{E}\\left[ {{W_t}} \\right] = 0. \\] \\[\\var \\left( {{X_t}} \\right) = \\theta_1^2 \\var \\left( W_{t - 1}\\right) + \\var \\left( W_{t}\\right) = \\left(1 + \\theta^2 \\right) \\sigma^2_w.\\] Regarding the autocovariance, we have \\[\\begin{aligned} \\cov\\left( {{X_t},{X_{t + h}}} \\right) &amp;= \\mathbb{E}\\left[ {\\left( {{X_t} - \\mathbb{E}\\left[ {{X_t}} \\right]} \\right)\\left( {{X_{t + h}} - \\mathbb{E}\\left[ {{X_{t + h}}} \\right]} \\right)} \\right] = \\mathbb{E}\\left[ {{X_t}{X_{t + h}}} \\right] \\\\ &amp;= \\mathbb{E}\\left[ {\\left( {{\\theta}{W_{t - 1}} + {W_t}} \\right)\\left( {{\\theta }{W_{t + h - 1}} + {W_{t + h}}} \\right)} \\right] \\\\ &amp;= \\mathbb{E}\\left[ {\\theta^2{W_{t - 1}}{W_{t + h - 1}} + \\theta {W_t}{W_{t + h}} + {\\theta}{W_{t - 1}}{W_{t + h}} + {W_t}{W_{t + h}}} \\right]. \\\\ \\end{aligned} \\] It is easy to see that \\(\\mathbb{E}\\left[ {{W_t}{W_{t + h}}} \\right] = {\\boldsymbol{1}_{\\left\\{ {h = 0} \\right\\}}}\\sigma _w^2\\) and therefore, we obtain \\[\\cov \\left( {{X_t},{X_{t + h}}} \\right) = \\left( {\\theta^2{ \\boldsymbol{1}_{\\left\\{ {h = 0} \\right\\}}} + {\\theta}{\\boldsymbol{1}_{\\left\\{ {h = 1} \\right\\}}} + {\\theta}{\\boldsymbol{1}_{\\left\\{ {h = - 1} \\right\\}}} + {\\boldsymbol{1}_{\\left\\{ {h = 0} \\right\\}}}} \\right)\\sigma _w^2\\] implying the following autocovariance function: \\[\\gamma \\left( h \\right) = \\left\\{ {\\begin{array}{*{20}{c}} {\\left( {\\theta^2 + 1} \\right)\\sigma _w^2}&amp;{h = 0} \\\\ {{\\theta}\\sigma _w^2}&amp;{\\left| h \\right| = 1} \\\\ 0&amp;{\\left| h \\right| &gt; 1} \\end{array}} \\right. .\\] Therefore, an MA(1) process is weakly stationary since both the mean and variance are constant over time and its covariance function is only a function of the lag \\(h\\). Finally, we can easily obtain the autocorrelation for this process, which is given by \\[\\rho \\left( h \\right) = \\left\\{ {\\begin{array}{*{20}{c}} 1&amp;{h = 0} \\\\ {\\frac{{{\\theta}\\sigma _w^2}}{{\\left( {\\theta^2 + 1} \\right)\\sigma _w^2}} = \\frac{{{\\theta}}}{{\\theta^2 + 1}}}&amp;{\\left| h \\right| = 1} \\\\ 0&amp;{\\left| h \\right| &gt; 1} \\end{array}} \\right. .\\] Interestingly, we can note that \\(|\\rho(1)| \\leq 0.5\\). Example AR(1) As another example, we shall verify the stationary properties for the AR(1) model defined in Section 1.3.3. Using the backsubstitution technique, we can rearrange an AR(1) process so that it is written in a more compact form, i.e. \\[\\begin{aligned} {X_t} &amp; = {\\phi }{X_{t - 1}} + {W_t} = \\phi \\left[ {\\phi {X_{t - 2}} + {W_{t - 1}}} \\right] + {W_t} = {\\phi ^2}{X_{t - 2}} + \\phi {W_{t - 1}} + {W_t} \\\\ &amp; \\vdots \\\\ &amp; = {\\phi ^k}{X_{t-k}} + \\sum\\limits_{j = 0}^{k - 1} {{\\phi ^j}{W_{t - j}}} . \\end{aligned} \\] By taking the limit in \\(k\\) (which is perfectly valid as we assume \\(t \\in \\mathbb{Z}\\)) and assuming \\(|\\phi|&lt;1\\), we obtain \\[\\begin{aligned} X_t = \\mathop {\\lim }\\limits_{k \\to \\infty} \\; {X_t} = \\sum\\limits_{j = 0}^{\\infty} {{\\phi ^j}{W_{t - j}}} \\end{aligned} \\] and therefore such process can be interpreted as a linear combination of the white noise \\((W_t)\\) and corresponds (as we will later on) to an MA(\\(\\infty\\)). In addition, the requirement \\(\\left| \\phi \\right| &lt; 1\\) turns out to be extremely useful as the above formula is related to Geometric series which would diverge if \\(\\phi \\geq 1\\). Indeed, remember that an infinite (converging) Geometric series is given by \\[\\sum\\limits_{k = 0}^\\infty \\, a{{r^k}} = \\frac{a}{{1 - r}}, \\; {\\text{ if }}\\left| r \\right| &lt; 1.\\] With this setup, we demonstrate how crucial this property is by calculating each of the requirements of a stationary process. First, we will check to see if the mean is stationary. In this case, we opt to use limits to derive the expectation \\[\\begin{aligned} \\mathbb{E}\\left[ {{X_t}} \\right] &amp;= \\mathop {\\lim }\\limits_{k \\to \\infty } \\mathbb{E}\\left[ {{\\phi^k}{X_{t-k}} + \\sum\\limits_{j = 0}^{k - 1} {\\phi^j{W_{t - j}}} } \\right] = \\mathop {\\lim }\\limits_{k \\to \\infty } \\, \\underbrace {{\\phi ^k}{\\mathbb{E}[X_{t-k}]}}_{= 0} + \\mathop {\\lim }\\limits_{k \\to \\infty } \\, \\sum\\limits_{j = 0}^{k - 1} {\\phi^j\\underbrace {\\mathbb{E}\\left[ {{W_{t - j}}} \\right]}_{ = 0}} = 0. \\end{aligned} \\] As expected, the mean is zero and, hence, the first criteria for weak stationarity is satisfied. Next, we opt to determine the variance of the process \\[\\begin{aligned} \\var\\left( {{X_t}} \\right) &amp;= \\mathop {\\lim }\\limits_{k \\to \\infty } \\var\\left( {{\\phi^k}{X_{t-k}} + \\sum\\limits_{j = 0}^{k - 1} {\\phi^j{W_{t - j}}} } \\right) = \\mathop {\\lim }\\limits_{k \\to \\infty } \\sum\\limits_{j = 0}^{k - 1} {\\phi ^{2j} \\var\\left( {{W_{t - j}}} \\right)} \\\\ &amp;= \\mathop {\\lim }\\limits_{k \\to \\infty } \\sum\\limits_{j = 0}^{k - 1} \\sigma _W^2 \\, {\\phi ^{2j}} = \\underbrace {\\frac{\\sigma _W^2}{{1 - {\\phi ^2}}}.}_{\\begin{subarray}{l} {\\text{Geom. Serie}} \\end{subarray}} \\end{aligned} \\] Once again, the above result only holds because we are able to use the geometric series convergence as a result of \\(\\left| \\phi \\right| &lt; 1\\). Finally, we consider the autocovariance of an AR(1). For \\(h &gt; 0\\), we have \\[\\gamma \\left( h \\right) = \\cov\\left( {{X_t},{X_{t + h}}} \\right) = \\phi \\cov\\left( {{X_t},{X_{t + h - 1}}} \\right) = \\phi \\, \\gamma \\left( h-1 \\right).\\] Therefore, we using the symmetry of the autocovariance we have that \\[\\gamma \\left( h \\right) = |h| \\, \\gamma(0).\\] Both the mean and variance do not depend on time in addition the autocovariance function can be viewed as function dependent on only lags and, thus, the AR(1) process is weakly stationary if \\(\\left| \\phi \\right| &lt; 1\\). Lastly, we can obtain the autocorrelation for this process. Indeed, for \\(h &gt; 0\\), we have \\[\\rho \\left( h \\right) = \\frac{{\\gamma \\left( h \\right)}}{{\\gamma \\left( 0 \\right)}} = \\frac{{\\phi \\gamma \\left( {h - 1} \\right)}}{{\\gamma \\left( 0 \\right)}} = \\phi \\rho \\left( {h - 1} \\right).\\] After fully simplifying, we obtain \\[\\rho \\left( h \\right) = {\\phi^{|h|}}.\\] Thus, the autocorrelation function for an AR(1) exhibits a geometric decay. As in, the smaller the \\(|\\phi|\\), the faster the autocorrelation reaches zero. If \\(|\\phi|\\) is close to 1, then the decay rate is slower. "]
]
